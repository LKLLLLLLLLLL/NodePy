{"openapi":"3.1.0","info":{"title":"NodePy API","version":"0.1.0"},"paths":{"/api/project/{project_id}":{"get":{"summary":"Get Graph","description":"Get the node graph for a project.","operationId":"get_graph_api_project__project_id__get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"integer","title":"Project Id"}}],"responses":{"200":{"description":"Graph retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Graph-Output"}}}},"404":{"description":"Project or graph not found"},"403":{"description":"User has no access to this project"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/project/sync":{"post":{"summary":"Sync Graph","description":"Save a node graph to the database, if topology changed, enqueue a task to execute it.\nIf decide to execute, enqueues a Celery task. Use\nthe returned `task_id` to subscribe to the websocket status endpoint\n`/nodes/status/{task_id}`.","operationId":"sync_graph_api_project_sync_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Graph-Input"}}},"required":true},"responses":{"202":{"description":"Task accepted and running","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponse","anyOf":[{"$ref":"#/components/schemas/TaskResponse"},{"$ref":"#/components/schemas/NothingTodoResponse"}],"title":"Response Sync Graph Api Project Sync Post"}}}},"403":{"description":"User has no access to this project"},"404":{"description":"Project not found"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/project/data/{data_id}":{"get":{"summary":"Get Node Data","description":"Get the data generated by a node.","operationId":"get_node_data_api_project_data__data_id__get","parameters":[{"name":"data_id","in":"path","required":true,"schema":{"type":"integer","title":"Data Id"}}],"responses":{"200":{"description":"Data retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DataView"}}}},"404":{"description":"Data not found"},"403":{"description":"User has no access to this data"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/files/upload/{project_id}":{"post":{"summary":"Upload File","description":"Upload a file to a project. Return the saved file info.","operationId":"upload_file_api_files_upload__project_id__post","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"integer","title":"Project Id"}},{"name":"node_id","in":"query","required":true,"schema":{"type":"string","title":"Node Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_api_files_upload__project_id__post"}}}},"responses":{"201":{"description":"File uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/File"}}}},"400":{"description":"Bad Request - invalid file or parameters"},"403":{"description":"Forbidden - not allowed"},"500":{"description":"Internal Server Error"},"507":{"description":"Insufficient Storage - user storage limit exceeded"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/files/{key}":{"get":{"summary":"Get File Content","description":"Get the content of a file by its key and project id.\nThe project id is used to verify the access permission.\n\n**important: if user want to re upload a file, you need to delete the old file first,\notherwise the file space may not be released.**","operationId":"get_file_content_api_files__key__get","parameters":[{"name":"key","in":"path","required":true,"schema":{"type":"string","title":"Key"}}],"responses":{"200":{"description":"Binary file content","content":{"application/json":{"schema":{}},"application/octet-stream":{"schema":{"type":"string","format":"binary"}}}},"403":{"description":"Forbidden - not allowed to access this file"},"404":{"description":"File not found"},"500":{"description":"Internal Server Error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Delete File","description":"Delete a file by its key and project id.\nThe project id is used to verify the access permission.","operationId":"delete_file_api_files__key__delete","parameters":[{"name":"key","in":"path","required":true,"schema":{"type":"string","title":"Key"}}],"responses":{"200":{"description":"File deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteResponse"},"example":{"status":"success"}}}},"403":{"description":"Forbidden - not allowed to access this file"},"404":{"description":"File not found"},"500":{"description":"Internal Server Error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/files/list":{"get":{"summary":"List Files","operationId":"list_files_api_files_list_get","responses":{"200":{"description":"List of files for the user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserFileList"}}}},"404":{"description":"Not Found"},"500":{"description":"Internal Server Error"}}}}},"components":{"schemas":{"Body_upload_file_api_files_upload__project_id__post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_file_api_files_upload__project_id__post"},"ColType":{"type":"string","enum":["int","float","str","bool","datetime"],"title":"ColType"},"DataView":{"properties":{"type":{"type":"string","enum":["int","float","str","bool","Table","File"],"title":"Type"},"value":{"anyOf":[{"$ref":"#/components/schemas/TableView"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"$ref":"#/components/schemas/File"}],"title":"Value"}},"type":"object","required":["type","value"],"title":"DataView","description":"A dict-like view of data, for transmitting or json serialization."},"DataZip":{"properties":{"url":{"type":"string","title":"Url"}},"type":"object","required":["url"],"title":"DataZip","description":"A lightweight representation of data,\nit store only the url of the data object."},"DeleteResponse":{"properties":{"status":{"type":"string","title":"Status"}},"type":"object","required":["status"],"title":"DeleteResponse"},"Edge":{"properties":{"id":{"type":"string","title":"Id"},"src":{"type":"string","title":"Src"},"src_port":{"type":"string","title":"Src Port"},"tar":{"type":"string","title":"Tar"},"tar_port":{"type":"string","title":"Tar Port"}},"type":"object","required":["id","src","src_port","tar","tar_port"],"title":"Edge"},"File":{"properties":{"key":{"type":"string","title":"Key"},"filename":{"type":"string","title":"Filename"},"format":{"type":"string","enum":["png","jpg","pdf","csv"],"title":"Format"},"size":{"type":"integer","title":"Size"}},"type":"object","required":["key","filename","format","size"],"title":"File","description":"A abstract file class to represent files managed by FileManager."},"FileItem":{"properties":{"key":{"type":"string","title":"Key"},"filename":{"type":"string","title":"Filename"},"format":{"type":"string","enum":["png","jpg","pdf","csv"],"title":"Format"},"size":{"type":"integer","title":"Size"},"uploaded_at":{"type":"string","title":"Uploaded At"},"project_name":{"type":"string","title":"Project Name"}},"type":"object","required":["key","filename","format","size","uploaded_at","project_name"],"title":"FileItem","description":"The file item showed in the file list."},"Graph-Input":{"properties":{"project_name":{"type":"string","title":"Project Name"},"project_id":{"type":"integer","title":"Project Id"},"user_id":{"type":"integer","title":"User Id"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"nodes":{"items":{"$ref":"#/components/schemas/Node-Input"},"type":"array","title":"Nodes"},"edges":{"items":{"$ref":"#/components/schemas/Edge"},"type":"array","title":"Edges"}},"type":"object","required":["project_name","project_id","user_id","nodes","edges"],"title":"Graph","description":"A unified data structure for all data for a node graph."},"Graph-Output":{"properties":{"project_name":{"type":"string","title":"Project Name"},"project_id":{"type":"integer","title":"Project Id"},"user_id":{"type":"integer","title":"User Id"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"nodes":{"items":{"$ref":"#/components/schemas/Node-Output"},"type":"array","title":"Nodes"},"edges":{"items":{"$ref":"#/components/schemas/Edge"},"type":"array","title":"Edges"}},"type":"object","required":["project_name","project_id","user_id","nodes","edges"],"title":"Graph","description":"A unified data structure for all data for a node graph."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Node-Input":{"properties":{"id":{"type":"string","title":"Id"},"type":{"type":"string","title":"Type"},"position":{"$ref":"#/components/schemas/Position","default":{"x":0.0,"y":0.0}},"param":{"additionalProperties":true,"type":"object","title":"Param","default":{}},"runningtime":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Runningtime"},"schema_out":{"additionalProperties":{"$ref":"#/components/schemas/Schema-Input"},"type":"object","title":"Schema Out","default":{}},"data_out":{"additionalProperties":{"$ref":"#/components/schemas/DataZip"},"type":"object","title":"Data Out","default":{}},"error":{"anyOf":[{"$ref":"#/components/schemas/NodeError"},{"type":"null"}]}},"type":"object","required":["id","type"],"title":"Node"},"Node-Output":{"properties":{"id":{"type":"string","title":"Id"},"type":{"type":"string","title":"Type"},"position":{"$ref":"#/components/schemas/Position","default":{"x":0.0,"y":0.0}},"param":{"additionalProperties":true,"type":"object","title":"Param","default":{}},"runningtime":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Runningtime"},"schema_out":{"additionalProperties":{"$ref":"#/components/schemas/Schema-Output"},"type":"object","title":"Schema Out","default":{}},"data_out":{"additionalProperties":{"$ref":"#/components/schemas/DataZip"},"type":"object","title":"Data Out","default":{}},"error":{"anyOf":[{"$ref":"#/components/schemas/NodeError"},{"type":"null"}]}},"type":"object","required":["id","type"],"title":"Node"},"NodeError":{"properties":{"param":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Param"},"input":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Input"},"message":{"type":"string","title":"Message"}},"type":"object","required":["param","input","message"],"title":"NodeError"},"NothingTodoResponse":{"properties":{},"type":"object","title":"NothingTodoResponse"},"Position":{"properties":{"x":{"type":"number","title":"X"},"y":{"type":"number","title":"Y"}},"type":"object","required":["x","y"],"title":"Position"},"Schema-Input":{"properties":{"type":{"$ref":"#/components/schemas/Type"},"tab":{"anyOf":[{"$ref":"#/components/schemas/TableSchema"},{"type":"null"}]}},"type":"object","required":["type"],"title":"Schema"},"Schema-Output":{"properties":{"type":{"$ref":"#/components/schemas/Type"},"tab":{"anyOf":[{"$ref":"#/components/schemas/TableSchema"},{"type":"null"}]}},"type":"object","required":["type"],"title":"Schema"},"TableSchema":{"properties":{"col_types":{"additionalProperties":{"$ref":"#/components/schemas/ColType"},"type":"object","title":"Col Types"}},"type":"object","required":["col_types"],"title":"TableSchema","description":"The schema of Table data."},"TableView":{"properties":{"cols":{"additionalProperties":{"items":{"anyOf":[{"type":"string"},{"type":"boolean"},{"type":"integer"},{"type":"number"}]},"type":"array"},"type":"object","title":"Cols"},"col_types":{"additionalProperties":{"type":"string"},"type":"object","title":"Col Types"}},"type":"object","required":["cols","col_types"],"title":"TableView"},"TaskResponse":{"properties":{"task_id":{"type":"string","title":"Task Id"}},"type":"object","required":["task_id"],"title":"TaskResponse","description":"Response returned when a task is submitted."},"Type":{"type":"string","enum":["Table","str","int","bool","float","File"],"title":"Type"},"UserFileList":{"properties":{"user_id":{"type":"integer","title":"User Id"},"files":{"items":{"$ref":"#/components/schemas/FileItem"},"type":"array","title":"Files"},"total_size":{"type":"integer","title":"Total Size"},"used_size":{"type":"integer","title":"Used Size"}},"type":"object","required":["user_id","files","total_size","used_size"],"title":"UserFileList","description":"The list of files owned by a user."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}